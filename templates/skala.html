<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Zakres wokalny (interaktywny)</title>
    <style>
        button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 1.1rem;
        }
        select {
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <h1>ğŸ¤ SprawdÅº swÃ³j zakres wokalny</h1>

    <!-- WybÃ³r pÅ‚ci -->
    <h3>Wybierz swojÄ… pÅ‚eÄ‡:</h3>
    <form method="POST" action="/analizuj_skale_manualnie">
        <label>
            <input type="radio" name="plec" value="kobieta" required> ğŸ‘© Kobieta
        </label>
        <label>
            <input type="radio" name="plec" value="mezczyzna" required> ğŸ§‘ MÄ™Å¼czyzna
        </label>

        <br><br>

        <!-- NajniÅ¼sza nuta -->
        <h3>NajniÅ¼szy dÅºwiÄ™k jaki potrafisz zaÅ›piewaÄ‡:</h3>
        <select name="nuta_niska" required>
            {% for note in nuty %}
                <option value="{{ note[1] }}">{{ note[0] }} ({{ note[1] }} Hz)</option>
            {% endfor %}
        </select>
        <button type="button" onclick="playSelected('nuta_niska')">ğŸ”Š OdtwÃ³rz</button>

        <!-- NajwyÅ¼sza nuta -->
        <h3>NajwyÅ¼szy dÅºwiÄ™k jaki potrafisz zaÅ›piewaÄ‡:</h3>
        <select name="nuta_wysoka" required>
            {% for note in nuty %}
                <option value="{{ note[1] }}">{{ note[0] }} ({{ note[1] }} Hz)</option>
            {% endfor %}
        </select>
        <button type="button" onclick="playSelected('nuta_wysoka')">ğŸ”Š OdtwÃ³rz</button>

        <br><br>
        <button type="submit">ğŸ“ˆ SprawdÅº mÃ³j zakres gÅ‚osu</button>
    </form>

    {% if wynik %}
        <h2>ğŸ“Š TwÃ³j zakres:</h2>
        <p><strong>{{ wynik.nuta_niska }}</strong> ({{ wynik.niska_hz }} Hz) â†’ 
           <strong>{{ wynik.nuta_wysoka }}</strong> ({{ wynik.wysoka_hz }} Hz)</p>
        <p><strong>Zakres:</strong> {{ wynik.zakres }} Hz</p>
        <p><strong>Typ gÅ‚osu:</strong> ğŸ¶ {{ wynik.typ_glosu }}</p>
    {% endif %}

    <script>
        function playSelected(selectName) {
            const select = document.getElementsByName(selectName)[0];
            const freq = parseFloat(select.value);

            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(freq, audioCtx.currentTime);
            oscillator.connect(audioCtx.destination);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 1.5);
        }
    </script>

    <br><br>
    <a href="/">â¬…ï¸ WrÃ³Ä‡</a>
</body>
</html>
